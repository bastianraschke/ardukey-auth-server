<?xml version="1.0" encoding="ascii"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
          "DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>pyhsm.base.YHSM</title>
  <link rel="stylesheet" href="epydoc.css" type="text/css" />
  <script type="text/javascript" src="epydoc.js"></script>
</head>

<body bgcolor="white" text="black" link="blue" vlink="#204080"
      alink="#204080">
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">
  <!-- Home link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="pyhsm-module.html">Home</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Project homepage -->
      <th class="navbar" align="right" width="100%">
        <table border="0" cellpadding="0" cellspacing="0">
          <tr><th class="navbar" align="center"
            >pyhsm</th>
          </tr></table></th>
  </tr>
</table>
<table width="100%" cellpadding="0" cellspacing="0">
  <tr valign="top">
    <td width="100%">
      <span class="breadcrumbs">
        <a href="pyhsm-module.html">Package&nbsp;pyhsm</a> ::
        <a href="pyhsm.base-module.html">Module&nbsp;base</a> ::
        Class&nbsp;YHSM
      </span>
    </td>
    <td>
      <table cellpadding="0" cellspacing="0">
        <!-- hide/show private -->
        <tr><td align="right"><span class="options"
            >[<a href="frames.html" target="_top">frames</a
            >]&nbsp;|&nbsp;<a href="pyhsm.base.YHSM-class.html"
            target="_top">no&nbsp;frames</a>]</span></td></tr>
      </table>
    </td>
  </tr>
</table>
<!-- ==================== CLASS DESCRIPTION ==================== -->
<h1 class="epydoc">Class YHSM</h1><p class="nomargin-top"></p>
<p>Base class for accessing a YubiHSM.</p>

<!-- ==================== INSTANCE METHODS ==================== -->
<a name="section-InstanceMethods"></a>
<table class="summary" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td align="left" colspan="2" class="table-header">
    <span class="table-header">Instance Methods</span></td>
</tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="__init__"></a><span class="summary-sig-name">__init__</span>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">device</span>,
        <span class="summary-sig-arg">debug</span>=<span class="summary-sig-default">False</span>,
        <span class="summary-sig-arg">timeout</span>=<span class="summary-sig-default">1</span>,
        <span class="summary-sig-arg">test_comm</span>=<span class="summary-sig-default">True</span>)</span></td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="__repr__"></a><span class="summary-sig-name">__repr__</span>(<span class="summary-sig-arg">self</span>)</span></td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">bool</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="pyhsm.base.YHSM-class.html#reset" class="summary-sig-name">reset</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">test_sync</span>=<span class="summary-sig-default">True</span>)</span><br />
      Perform stream resynchronization.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">bool</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="pyhsm.base.YHSM-class.html#set_debug" class="summary-sig-name">set_debug</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">new</span>)</span><br />
      Set debug mode.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="pyhsm.base.YHSM-class.html#test_comm" class="summary-sig-name">test_comm</a>(<span class="summary-sig-arg">self</span>)</span><br />
      Verify that data we send to and receive from the YubiHSM isn't 
      mangled.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">string</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="pyhsm.base.YHSM-class.html#echo" class="summary-sig-name">echo</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">data</span>)</span><br />
      Echo test.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type"><a href="pyhsm.basic_cmd.YHSM_Cmd_System_Info-class.html" 
      class="link">YHSM_Cmd_System_Info</a></span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="pyhsm.base.YHSM-class.html#info" class="summary-sig-name">info</a>(<span class="summary-sig-arg">self</span>)</span><br />
      Get firmware version and unique ID from YubiHSM.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">string</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="pyhsm.base.YHSM-class.html#random" class="summary-sig-name">random</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">num_bytes</span>)</span><br />
      Get random bytes from YubiHSM.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">bool</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="pyhsm.base.YHSM-class.html#random_reseed" class="summary-sig-name">random_reseed</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">seed</span>)</span><br />
      Provide YubiHSM DRBG_CTR with a new seed.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type"><a href="pyhsm.basic_cmd.YHSM_NonceResponse-class.html" 
      class="link">YHSM_NonceResponse</a></span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="pyhsm.base.YHSM-class.html#get_nonce" class="summary-sig-name">get_nonce</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">increment</span>=<span class="summary-sig-default">1</span>)</span><br />
      Get current nonce from YubiHSM.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">bool</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="pyhsm.base.YHSM-class.html#load_temp_key" class="summary-sig-name">load_temp_key</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">nonce</span>,
        <span class="summary-sig-arg">key_handle</span>,
        <span class="summary-sig-arg">aead</span>)</span><br />
      Load the contents of an AEAD into the phantom key handle 0xffffffff.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">bool</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="pyhsm.base.YHSM-class.html#unlock" class="summary-sig-name">unlock</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">password</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">otp</span>=<span class="summary-sig-default">None</span>)</span><br />
      Unlock the YubiHSM using the master key and/or a YubiKey OTP.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="pyhsm.base.YHSM-class.html#key_storage_unlock" class="summary-sig-name">key_storage_unlock</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">password</span>)</span></td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">integer</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="pyhsm.base.YHSM-class.html#load_secret" class="summary-sig-name">load_secret</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">secret</span>)</span><br />
      Ask YubiHSM to load a pre-existing YubiKey secret.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">integer</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="pyhsm.base.YHSM-class.html#load_data" class="summary-sig-name">load_data</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">data</span>,
        <span class="summary-sig-arg">offset</span>)</span><br />
      Ask YubiHSM to load arbitrary data into it's internal buffer, at any 
      offset.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">integer</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="pyhsm.base.YHSM-class.html#load_random" class="summary-sig-name">load_random</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">num_bytes</span>,
        <span class="summary-sig-arg">offset</span>=<span class="summary-sig-default">0</span>)</span><br />
      Ask YubiHSM to generate a number of random bytes to any offset of 
      it's internal buffer.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type"><a href="pyhsm.aead_cmd.YHSM_GeneratedAEAD-class.html" 
      class="link">YHSM_GeneratedAEAD</a></span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="pyhsm.base.YHSM-class.html#generate_aead_simple" class="summary-sig-name">generate_aead_simple</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">nonce</span>,
        <span class="summary-sig-arg">key_handle</span>,
        <span class="summary-sig-arg">data</span>)</span><br />
      Generate AEAD block from data for a specific key in a single step 
      (without using the YubiHSM internal buffer).</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type"><a href="pyhsm.aead_cmd.YHSM_GeneratedAEAD-class.html" 
      class="link">YHSM_GeneratedAEAD</a></span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="pyhsm.base.YHSM-class.html#generate_aead_random" class="summary-sig-name">generate_aead_random</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">nonce</span>,
        <span class="summary-sig-arg">key_handle</span>,
        <span class="summary-sig-arg">num_bytes</span>)</span><br />
      Generate a random AEAD block using the YubiHSM internal DRBG_CTR 
      random generator.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type"><a href="pyhsm.aead_cmd.YHSM_GeneratedAEAD-class.html" 
      class="link">YHSM_GeneratedAEAD</a></span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="pyhsm.base.YHSM-class.html#generate_aead" class="summary-sig-name">generate_aead</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">nonce</span>,
        <span class="summary-sig-arg">key_handle</span>)</span><br />
      Ask YubiHSM to return an AEAD made of the contents of it's internal 
      buffer (see <a href="pyhsm.base.YHSM-class.html#load_secret" 
      class="link">load_secret</a>, <a 
      href="pyhsm.base.YHSM-class.html#load_data" 
      class="link">load_data</a> and <a 
      href="pyhsm.base.YHSM-class.html#load_random" 
      class="link">load_random</a>) encrypted with the specified 
      key_handle.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">bool</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="pyhsm.base.YHSM-class.html#validate_aead" class="summary-sig-name">validate_aead</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">nonce</span>,
        <span class="summary-sig-arg">key_handle</span>,
        <span class="summary-sig-arg">aead</span>,
        <span class="summary-sig-arg">cleartext</span>)</span><br />
      Validate the contents of an AEAD using the YubiHSM.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type"><a href="pyhsm.validate_cmd.YHSM_ValidationResult-class.html" 
      class="link">YHSM_ValidationResult</a></span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="pyhsm.base.YHSM-class.html#validate_aead_otp" class="summary-sig-name">validate_aead_otp</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">public_id</span>,
        <span class="summary-sig-arg">otp</span>,
        <span class="summary-sig-arg">key_handle</span>,
        <span class="summary-sig-arg">aead</span>)</span><br />
      Ask YubiHSM to validate a YubiKey OTP using an AEAD and a key_handle 
      to decrypt the AEAD.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">NoneType</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="pyhsm.base.YHSM-class.html#monitor_exit" class="summary-sig-name">monitor_exit</a>(<span class="summary-sig-arg">self</span>)</span><br />
      Ask YubiHSM to exit to configuration mode (requires 'debug' mode 
      enabled).</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">Serial</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="pyhsm.base.YHSM-class.html#get_raw_device" class="summary-sig-name">get_raw_device</a>(<span class="summary-sig-arg">self</span>)</span><br />
      Get the raw device.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">bool</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="pyhsm.base.YHSM-class.html#drain" class="summary-sig-name">drain</a>(<span class="summary-sig-arg">self</span>)</span><br />
      Read until there is nothing more to be read.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">string</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="pyhsm.base.YHSM-class.html#aes_ecb_encrypt" class="summary-sig-name">aes_ecb_encrypt</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">key_handle</span>,
        <span class="summary-sig-arg">plaintext</span>)</span><br />
      AES ECB encrypt using a key handle.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">string</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="pyhsm.base.YHSM-class.html#aes_ecb_decrypt" class="summary-sig-name">aes_ecb_decrypt</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">key_handle</span>,
        <span class="summary-sig-arg">ciphertext</span>)</span><br />
      AES ECB decrypt using a key handle.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">bool</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="pyhsm.base.YHSM-class.html#aes_ecb_compare" class="summary-sig-name">aes_ecb_compare</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">key_handle</span>,
        <span class="summary-sig-arg">ciphertext</span>,
        <span class="summary-sig-arg">plaintext</span>)</span><br />
      AES ECB decrypt and then compare using a key handle.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type"><a href="pyhsm.hmac_cmd.YHSM_Cmd_HMAC_SHA1_Write-class.html" 
      class="link">YHSM_Cmd_HMAC_SHA1_Write</a></span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="pyhsm.base.YHSM-class.html#hmac_sha1" class="summary-sig-name">hmac_sha1</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">key_handle</span>,
        <span class="summary-sig-arg">data</span>,
        <span class="summary-sig-arg">flags</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">final</span>=<span class="summary-sig-default">True</span>,
        <span class="summary-sig-arg">to_buffer</span>=<span class="summary-sig-default">False</span>)</span><br />
      Have the YubiHSM generate a HMAC SHA1 of 'data' using a key handle.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">bool</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="pyhsm.base.YHSM-class.html#db_store_yubikey" class="summary-sig-name">db_store_yubikey</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">public_id</span>,
        <span class="summary-sig-arg">key_handle</span>,
        <span class="summary-sig-arg">aead</span>,
        <span class="summary-sig-arg">nonce</span>=<span class="summary-sig-default">None</span>)</span><br />
      Ask YubiHSM to store data about a YubiKey in the internal database 
      (not buffer).</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type"><a href="pyhsm.validate_cmd.YHSM_ValidationResult-class.html" 
      class="link">YHSM_ValidationResult</a></span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="pyhsm.base.YHSM-class.html#db_validate_yubikey_otp" class="summary-sig-name">db_validate_yubikey_otp</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">public_id</span>,
        <span class="summary-sig-arg">otp</span>)</span><br />
      Request the YubiHSM to validate an OTP for a YubiKey stored in the 
      internal database.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
</table>
<!-- ==================== METHOD DETAILS ==================== -->
<a name="section-MethodDetails"></a>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td align="left" colspan="2" class="table-header">
    <span class="table-header">Method Details</span></td>
</tr>
</table>
<a name="reset"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">reset</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">test_sync</span>=<span class="sig-default">True</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>Perform stream resynchronization.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>test_sync</code></strong> (bool) - Verify sync with YubiHSM after reset</li>
    </ul></dd>
    <dt>Returns: bool</dt>
        <dd>True if successful</dd>
  </dl>
</td></tr></table>
</div>
<a name="set_debug"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">set_debug</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">new</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>Set debug mode.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>new</code></strong> (bool) - new value</li>
    </ul></dd>
    <dt>Returns: bool</dt>
        <dd>old value</dd>
  </dl>
</td></tr></table>
</div>
<a name="test_comm"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">test_comm</span>(<span class="sig-arg">self</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>Verify that data we send to and receive from the YubiHSM isn't 
  mangled.</p>
  <p>In some scenarios, communications with the YubiHSM might be affected 
  by terminal line settings turning CR into LF for example.</p>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="echo"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">echo</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">data</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>Echo test.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>data</code></strong> (string)</li>
    </ul></dd>
    <dt>Returns: string</dt>
        <dd>data read from YubiHSM -- should equal `data'</dd>
  </dl>
<div class="fields">      <p><strong>See Also:</strong>
        <a href="pyhsm.basic_cmd.YHSM_Cmd_Echo-class.html" 
        class="link">pyhsm.basic_cmd.YHSM_Cmd_Echo</a>
      </p>
</div></td></tr></table>
</div>
<a name="info"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">info</span>(<span class="sig-arg">self</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>Get firmware version and unique ID from YubiHSM.</p>
  <dl class="fields">
    <dt>Returns: <a href="pyhsm.basic_cmd.YHSM_Cmd_System_Info-class.html" 
      class="link">YHSM_Cmd_System_Info</a></dt>
        <dd>System information</dd>
  </dl>
<div class="fields">      <p><strong>See Also:</strong>
        <a href="pyhsm.basic_cmd.YHSM_Cmd_System_Info-class.html" 
        class="link">pyhsm.basic_cmd.YHSM_Cmd_System_Info</a>
      </p>
</div></td></tr></table>
</div>
<a name="random"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">random</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">num_bytes</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>Get random bytes from YubiHSM.</p>
  <p>The random data is DRBG_CTR seeded on each startup by a hardware TRNG,
  so it should be of very good quality.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>num_bytes</code></strong> (integer)</li>
    </ul></dd>
    <dt>Returns: string</dt>
        <dd>Bytes with random data</dd>
  </dl>
<div class="fields">      <p><strong>See Also:</strong>
        <a href="pyhsm.basic_cmd.YHSM_Cmd_Random-class.html" 
        class="link">pyhsm.basic_cmd.YHSM_Cmd_Random</a>
      </p>
</div></td></tr></table>
</div>
<a name="random_reseed"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">random_reseed</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">seed</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>Provide YubiHSM DRBG_CTR with a new seed.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>seed</code></strong> (string) - new seed -- must be exactly 32 bytes</li>
    </ul></dd>
    <dt>Returns: bool</dt>
        <dd>True on success</dd>
  </dl>
<div class="fields">      <p><strong>See Also:</strong>
        <a href="pyhsm.basic_cmd.YHSM_Cmd_Random_Reseed-class.html" 
        class="link">pyhsm.basic_cmd.YHSM_Cmd_Random_Reseed</a>
      </p>
</div></td></tr></table>
</div>
<a name="get_nonce"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">get_nonce</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">increment</span>=<span class="sig-default">1</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>Get current nonce from YubiHSM.</p>
  <p>Use increment 0 to just fetch the value without incrementing it.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>increment</code></strong> - requested increment (optional)</li>
    </ul></dd>
    <dt>Returns: <a href="pyhsm.basic_cmd.YHSM_NonceResponse-class.html" 
      class="link">YHSM_NonceResponse</a></dt>
        <dd>nonce value _before_ increment</dd>
  </dl>
<div class="fields">      <p><strong>See Also:</strong>
        <a href="pyhsm.basic_cmd.YHSM_Cmd_Nonce_Get-class.html" 
        class="link">pyhsm.basic_cmd.YHSM_Cmd_Nonce_Get</a>
      </p>
</div></td></tr></table>
</div>
<a name="load_temp_key"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">load_temp_key</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">nonce</span>,
        <span class="sig-arg">key_handle</span>,
        <span class="sig-arg">aead</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>Load the contents of an AEAD into the phantom key handle 
  0xffffffff.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>nonce</code></strong> (string) - The nonce used when creating the AEAD</li>
        <li><strong class="pname"><code>key_handle</code></strong> (integer or string) - The key handle that can decrypt the AEAD</li>
        <li><strong class="pname"><code>aead</code></strong> (<a href="pyhsm.aead_cmd.YHSM_GeneratedAEAD-class.html" 
          class="link">YHSM_GeneratedAEAD</a> or string) - AEAD containing the cryptographic key and permission flags</li>
    </ul></dd>
    <dt>Returns: bool</dt>
        <dd>True on success</dd>
  </dl>
<div class="fields">      <p><strong>See Also:</strong>
        <a href="pyhsm.basic_cmd.YHSM_Cmd_Temp_Key_Load-class.html" 
        class="link">pyhsm.basic_cmd.YHSM_Cmd_Temp_Key_Load</a>
      </p>
</div></td></tr></table>
</div>
<a name="unlock"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">unlock</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">password</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">otp</span>=<span class="sig-default">None</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>Unlock the YubiHSM using the master key and/or a YubiKey OTP.</p>
  <p>If the master key is given during configuration, all key handles will 
  be encrypted (with AES-256) using that passphrase.</p>
  <p>If one or more admin Yubikey public id's are given during 
  configuration, an OTP from one of these must be provided to the YubiHSM 
  for it to start responding to cryptographic requests. The admin YubiKeys 
  must be present in the internal database for this validation to work.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>password</code></strong> (NoneType or string) - The 'master key' set during YubiHSM configuration</li>
        <li><strong class="pname"><code>otp</code></strong> (NoneType or string) - A YubiKey OTP from an 'admin' YubiKey (modhex), to unlock 
          YubiHSM.</li>
    </ul></dd>
    <dt>Returns: bool</dt>
        <dd>Only returns (True) on success</dd>
  </dl>
<div class="fields">      <dl><dt>See Also:</dt>
        <dd>
          <a href="pyhsm.basic_cmd.YHSM_Cmd_Key_Storage_Unlock-class.html" 
          class="link">pyhsm.basic_cmd.YHSM_Cmd_Key_Storage_Unlock</a>,
          <a href="pyhsm.basic_cmd.YHSM_Cmd_HSM_Unlock-class.html" 
          class="link">pyhsm.basic_cmd.YHSM_Cmd_HSM_Unlock</a>
        </dd>
      </dl>
</div></td></tr></table>
</div>
<a name="key_storage_unlock"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">key_storage_unlock</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">password</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  
  <dl class="fields">
  </dl>
<div class="fields">      <p><strong>Deprecated:</strong>
        Too specific (and hard to remember) name.
      </p>
      <p><strong>See Also:</strong>
        <a href="pyhsm.base.YHSM-class.html#unlock" class="link">unlock</a>
      </p>
</div></td></tr></table>
</div>
<a name="load_secret"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">load_secret</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">secret</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>Ask YubiHSM to load a pre-existing YubiKey secret.</p>
  <p>The data is stored internally in the YubiHSM in temporary memory - 
  this operation would typically be followed by one or more <a 
  href="pyhsm.base.YHSM-class.html#generate_aead" 
  class="link">generate_aead</a> commands to actually retreive the 
  generated secret (in encrypted form).</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>secret</code></strong> (<a href="pyhsm.aead_cmd.YHSM_YubiKeySecret-class.html" 
          class="link">pyhsm.aead_cmd.YHSM_YubiKeySecret</a> or string) - YubiKey secret to load</li>
    </ul></dd>
    <dt>Returns: integer</dt>
        <dd>Number of bytes in YubiHSM internal buffer after load</dd>
  </dl>
<div class="fields">      <p><strong>See Also:</strong>
        <a href="pyhsm.buffer_cmd.YHSM_Cmd_Buffer_Load-class.html" 
        class="link">pyhsm.buffer_cmd.YHSM_Cmd_Buffer_Load</a>
      </p>
</div></td></tr></table>
</div>
<a name="load_data"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">load_data</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">data</span>,
        <span class="sig-arg">offset</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>Ask YubiHSM to load arbitrary data into it's internal buffer, at any 
  offset.</p>
  <p>The data is stored internally in the YubiHSM in temporary memory - 
  this operation would typically be followed by one or more <a 
  href="pyhsm.base.YHSM-class.html#generate_aead" 
  class="link">generate_aead</a> commands to actually retreive the 
  generated secret (in encrypted form).</p>
  <p>Load data to offset 0 to reset the buffer.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>data</code></strong> (string) - arbitrary data to load</li>
    </ul></dd>
    <dt>Returns: integer</dt>
        <dd>Number of bytes in YubiHSM internal buffer after load</dd>
  </dl>
<div class="fields">      <p><strong>See Also:</strong>
        <a href="pyhsm.buffer_cmd.YHSM_Cmd_Buffer_Load-class.html" 
        class="link">pyhsm.buffer_cmd.YHSM_Cmd_Buffer_Load</a>
      </p>
</div></td></tr></table>
</div>
<a name="load_random"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">load_random</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">num_bytes</span>,
        <span class="sig-arg">offset</span>=<span class="sig-default">0</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>Ask YubiHSM to generate a number of random bytes to any offset of it's
  internal buffer.</p>
  <p>The data is stored internally in the YubiHSM in temporary memory - 
  this operation would typically be followed by one or more <a 
  href="pyhsm.base.YHSM-class.html#generate_aead" 
  class="link">generate_aead</a> commands to actually retreive the 
  generated secret (in encrypted form).</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>num_bytes</code></strong> (integer) - Number of bytes to generate</li>
    </ul></dd>
    <dt>Returns: integer</dt>
        <dd>Number of bytes in YubiHSM internal buffer after load</dd>
  </dl>
<div class="fields">      <p><strong>See Also:</strong>
        <a href="pyhsm.buffer_cmd.YHSM_Cmd_Buffer_Random_Load-class.html" 
        class="link">pyhsm.buffer_cmd.YHSM_Cmd_Buffer_Random_Load</a>
      </p>
</div></td></tr></table>
</div>
<a name="generate_aead_simple"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">generate_aead_simple</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">nonce</span>,
        <span class="sig-arg">key_handle</span>,
        <span class="sig-arg">data</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>Generate AEAD block from data for a specific key in a single step 
  (without using the YubiHSM internal buffer).</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>nonce</code></strong> (string) - The nonce to use when creating the AEAD</li>
        <li><strong class="pname"><code>key_handle</code></strong> (integer or string) - The key handle that can encrypt data into an AEAD</li>
        <li><strong class="pname"><code>data</code></strong> (string) - Data to put inside the AEAD</li>
    </ul></dd>
    <dt>Returns: <a href="pyhsm.aead_cmd.YHSM_GeneratedAEAD-class.html" 
      class="link">YHSM_GeneratedAEAD</a></dt>
        <dd>The generated AEAD on success.</dd>
  </dl>
<div class="fields">      <p><strong>See Also:</strong>
        <a href="pyhsm.aead_cmd.YHSM_Cmd_AEAD_Generate-class.html" 
        class="link">pyhsm.aead_cmd.YHSM_Cmd_AEAD_Generate</a>
      </p>
</div></td></tr></table>
</div>
<a name="generate_aead_random"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">generate_aead_random</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">nonce</span>,
        <span class="sig-arg">key_handle</span>,
        <span class="sig-arg">num_bytes</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>Generate a random AEAD block using the YubiHSM internal DRBG_CTR 
  random generator.</p>
  <p>To generate a secret for a YubiKey, use public_id as nonce.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>nonce</code></strong> (string) - The nonce to use when creating the AEAD</li>
        <li><strong class="pname"><code>key_handle</code></strong> (integer or string) - The key handle that can encrypt the random data into an AEAD</li>
        <li><strong class="pname"><code>num_bytes</code></strong> (integer) - Number of random data bytes to put inside the AEAD</li>
    </ul></dd>
    <dt>Returns: <a href="pyhsm.aead_cmd.YHSM_GeneratedAEAD-class.html" 
      class="link">YHSM_GeneratedAEAD</a></dt>
        <dd>The generated AEAD on success.</dd>
  </dl>
<div class="fields">      <p><strong>See Also:</strong>
        <a href="pyhsm.aead_cmd.YHSM_Cmd_AEAD_Random_Generate-class.html" 
        class="link">pyhsm.aead_cmd.YHSM_Cmd_AEAD_Random_Generate</a>
      </p>
</div></td></tr></table>
</div>
<a name="generate_aead"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">generate_aead</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">nonce</span>,
        <span class="sig-arg">key_handle</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>Ask YubiHSM to return an AEAD made of the contents of it's internal 
  buffer (see <a href="pyhsm.base.YHSM-class.html#load_secret" 
  class="link">load_secret</a>, <a 
  href="pyhsm.base.YHSM-class.html#load_data" class="link">load_data</a> 
  and <a href="pyhsm.base.YHSM-class.html#load_random" 
  class="link">load_random</a>) encrypted with the specified 
  key_handle.</p>
  <p>For a YubiKey secret, the nonce should be the public_id.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>nonce</code></strong> (string) - The nonce to use when creating the AEAD</li>
        <li><strong class="pname"><code>key_handle</code></strong> (integer or string) - The key handle that can create an AEAD</li>
    </ul></dd>
    <dt>Returns: <a href="pyhsm.aead_cmd.YHSM_GeneratedAEAD-class.html" 
      class="link">YHSM_GeneratedAEAD</a></dt>
        <dd>The generated AEAD on success.</dd>
  </dl>
<div class="fields">      <p><strong>See Also:</strong>
        <a href="pyhsm.aead_cmd.YHSM_Cmd_AEAD_Buffer_Generate-class.html" 
        class="link">pyhsm.aead_cmd.YHSM_Cmd_AEAD_Buffer_Generate</a>
      </p>
</div></td></tr></table>
</div>
<a name="validate_aead"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">validate_aead</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">nonce</span>,
        <span class="sig-arg">key_handle</span>,
        <span class="sig-arg">aead</span>,
        <span class="sig-arg">cleartext</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>Validate the contents of an AEAD using the YubiHSM. The matching is 
  done inside the YubiHSM so the contents of the AEAD is never exposed 
  (well, except indirectionally when the cleartext does match).</p>
  <p>The cleartext should naturally be of the same length as the AEAD minus
  the size of the MAC (8 bytes).</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>nonce</code></strong> (string) - The nonce used when creating the AEAD</li>
        <li><strong class="pname"><code>key_handle</code></strong> (integer or string) - The key handle that can decrypt the AEAD</li>
        <li><strong class="pname"><code>aead</code></strong> (<a href="pyhsm.aead_cmd.YHSM_GeneratedAEAD-class.html" 
          class="link">YHSM_GeneratedAEAD</a> or string) - AEAD containing the cryptographic key and permission flags</li>
        <li><strong class="pname"><code>cleartext</code></strong> (string) - The presumed cleartext of the AEAD</li>
    </ul></dd>
    <dt>Returns: bool</dt>
        <dd>Whether or not the cleartext matches the contents of the AEAD.</dd>
  </dl>
<div class="fields">      <p><strong>See Also:</strong>
        <a href="pyhsm.aead_cmd.YHSM_Cmd_AEAD_Decrypt_Cmp-class.html" 
        class="link">pyhsm.aead_cmd.YHSM_Cmd_AEAD_Decrypt_Cmp</a>
      </p>
</div></td></tr></table>
</div>
<a name="validate_aead_otp"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">validate_aead_otp</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">public_id</span>,
        <span class="sig-arg">otp</span>,
        <span class="sig-arg">key_handle</span>,
        <span class="sig-arg">aead</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>Ask YubiHSM to validate a YubiKey OTP using an AEAD and a key_handle 
  to decrypt the AEAD.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>public_id</code></strong> (string) - The six bytes public id of the YubiKey</li>
        <li><strong class="pname"><code>otp</code></strong> (string) - The one time password (OTP) to validate</li>
        <li><strong class="pname"><code>key_handle</code></strong> (integer or string) - The key handle that can decrypt the AEAD</li>
        <li><strong class="pname"><code>aead</code></strong> (<a href="pyhsm.aead_cmd.YHSM_GeneratedAEAD-class.html" 
          class="link">YHSM_GeneratedAEAD</a> or string) - AEAD containing the cryptographic key and permission flags</li>
    </ul></dd>
    <dt>Returns: <a href="pyhsm.validate_cmd.YHSM_ValidationResult-class.html" 
      class="link">YHSM_ValidationResult</a></dt>
        <dd>validation response</dd>
  </dl>
<div class="fields">      <p><strong>See Also:</strong>
        <a href="pyhsm.validate_cmd.YHSM_Cmd_AEAD_Validate_OTP-class.html" 
        class="link">pyhsm.validate_cmd.YHSM_Cmd_AEAD_Validate_OTP</a>
      </p>
</div></td></tr></table>
</div>
<a name="monitor_exit"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">monitor_exit</span>(<span class="sig-arg">self</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>Ask YubiHSM to exit to configuration mode (requires 'debug' mode 
  enabled).</p>
  <dl class="fields">
    <dt>Returns: NoneType</dt>
        <dd>None</dd>
  </dl>
<div class="fields">      <p><strong>See Also:</strong>
        <a href="pyhsm.debug_cmd.YHSM_Cmd_Monitor_Exit-class.html" 
        class="link">pyhsm.debug_cmd.YHSM_Cmd_Monitor_Exit</a>
      </p>
</div></td></tr></table>
</div>
<a name="get_raw_device"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">get_raw_device</span>(<span class="sig-arg">self</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>Get the raw device. Only intended for test code/debugging!</p>
  <dl class="fields">
    <dt>Returns: Serial</dt>
        <dd>serial device</dd>
  </dl>
</td></tr></table>
</div>
<a name="drain"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">drain</span>(<span class="sig-arg">self</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>Read until there is nothing more to be read. Only intended for test 
  code/debugging!</p>
  <dl class="fields">
    <dt>Returns: bool</dt>
        <dd>True on success</dd>
  </dl>
</td></tr></table>
</div>
<a name="aes_ecb_encrypt"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">aes_ecb_encrypt</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">key_handle</span>,
        <span class="sig-arg">plaintext</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>AES ECB encrypt using a key handle.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>key_handle</code></strong> (integer or string) - Key handle to use for AES ECB encryption</li>
        <li><strong class="pname"><code>plaintext</code></strong> (string) - Data to encrypt</li>
    </ul></dd>
    <dt>Returns: string</dt>
        <dd>Ciphertext</dd>
  </dl>
<div class="fields">      <p><strong>Warning:</strong>
        Please be aware of the known limitations of AES ECB mode before 
        using it!
      </p>
      <p><strong>See Also:</strong>
        <a href="pyhsm.aes_ecb_cmd.YHSM_Cmd_AES_ECB_Encrypt-class.html" 
        class="link">pyhsm.aes_ecb_cmd.YHSM_Cmd_AES_ECB_Encrypt</a>
      </p>
</div></td></tr></table>
</div>
<a name="aes_ecb_decrypt"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">aes_ecb_decrypt</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">key_handle</span>,
        <span class="sig-arg">ciphertext</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>AES ECB decrypt using a key handle.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>key_handle</code></strong> (integer or string) - Key handle to use for AES ECB decryption</li>
        <li><strong class="pname"><code>ciphertext</code></strong> (string) - Data to decrypt</li>
    </ul></dd>
    <dt>Returns: string</dt>
        <dd>Plaintext</dd>
  </dl>
<div class="fields">      <p><strong>Warning:</strong>
        Please be aware of the known limitations of AES ECB mode before 
        using it!
      </p>
      <p><strong>See Also:</strong>
        <a href="pyhsm.aes_ecb_cmd.YHSM_Cmd_AES_ECB_Decrypt-class.html" 
        class="link">pyhsm.aes_ecb_cmd.YHSM_Cmd_AES_ECB_Decrypt</a>
      </p>
</div></td></tr></table>
</div>
<a name="aes_ecb_compare"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">aes_ecb_compare</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">key_handle</span>,
        <span class="sig-arg">ciphertext</span>,
        <span class="sig-arg">plaintext</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>AES ECB decrypt and then compare using a key handle.</p>
  <p>The comparison is done inside the YubiHSM so the plaintext is never 
  exposed (well, except indirectionally when the provided plaintext does 
  match).</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>key_handle</code></strong> (integer or string) - Key handle to use for AES ECB decryption</li>
        <li><strong class="pname"><code>plaintext</code></strong> (string) - Data to decrypt</li>
    </ul></dd>
    <dt>Returns: bool</dt>
        <dd>Match result</dd>
  </dl>
<div class="fields">      <p><strong>Warning:</strong>
        Please be aware of the known limitations of AES ECB mode before 
        using it!
      </p>
      <p><strong>See Also:</strong>
        <a href="pyhsm.aes_ecb_cmd.YHSM_Cmd_AES_ECB_Compare-class.html" 
        class="link">pyhsm.aes_ecb_cmd.YHSM_Cmd_AES_ECB_Compare</a>
      </p>
</div></td></tr></table>
</div>
<a name="hmac_sha1"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">hmac_sha1</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">key_handle</span>,
        <span class="sig-arg">data</span>,
        <span class="sig-arg">flags</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">final</span>=<span class="sig-default">True</span>,
        <span class="sig-arg">to_buffer</span>=<span class="sig-default">False</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>Have the YubiHSM generate a HMAC SHA1 of 'data' using a key 
  handle.</p>
  <p>Use the <a 
  href="pyhsm.hmac_cmd.YHSM_Cmd_HMAC_SHA1_Write-class.html#next" 
  class="link">pyhsm.hmac_cmd.YHSM_Cmd_HMAC_SHA1_Write.next</a> to add more
  input (until 'final' has been set to True).</p>
  <p>Use the <a 
  href="pyhsm.hmac_cmd.YHSM_Cmd_HMAC_SHA1_Write-class.html#get_hash" 
  class="link">pyhsm.hmac_cmd.YHSM_Cmd_HMAC_SHA1_Write.get_hash</a> to get 
  the hash result this far.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>key_handle</code></strong> (integer or string) - Key handle to use when generating HMAC SHA1</li>
        <li><strong class="pname"><code>data</code></strong> (string) - what to calculate the HMAC SHA1 checksum of</li>
        <li><strong class="pname"><code>flags</code></strong> (None or integer) - bit-flags, overrides 'final' and 'to_buffer'</li>
        <li><strong class="pname"><code>final</code></strong> - True when there is no more data, False if there is more</li>
        <li><strong class="pname"><code>to_buffer</code></strong> - Should the final result be stored in the YubiHSM internal buffer 
          or not</li>
    </ul></dd>
    <dt>Returns: <a href="pyhsm.hmac_cmd.YHSM_Cmd_HMAC_SHA1_Write-class.html" 
      class="link">YHSM_Cmd_HMAC_SHA1_Write</a></dt>
        <dd>HMAC-SHA1 instance</dd>
  </dl>
<div class="fields">      <p><strong>See Also:</strong>
        <a href="pyhsm.hmac_cmd.YHSM_Cmd_HMAC_SHA1_Write-class.html" 
        class="link">pyhsm.hmac_cmd.YHSM_Cmd_HMAC_SHA1_Write</a>
      </p>
</div></td></tr></table>
</div>
<a name="db_store_yubikey"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">db_store_yubikey</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">public_id</span>,
        <span class="sig-arg">key_handle</span>,
        <span class="sig-arg">aead</span>,
        <span class="sig-arg">nonce</span>=<span class="sig-default">None</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>Ask YubiHSM to store data about a YubiKey in the internal database 
  (not buffer).</p>
  <p>The input is an AEAD with the secrets of a YubiKey, perhaps previously
  created using <a href="pyhsm.base.YHSM-class.html#load_secret" 
  class="link">load_secret</a>.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>public_id</code></strong> (string) - The six bytes public id of the YubiKey</li>
        <li><strong class="pname"><code>key_handle</code></strong> (integer or string) - Key handle that can decrypt the YubiKey AEAD</li>
        <li><strong class="pname"><code>aead</code></strong> (<a href="pyhsm.aead_cmd.YHSM_GeneratedAEAD-class.html" 
          class="link">YHSM_GeneratedAEAD</a> or string) - AEAD of an <a href="pyhsm.aead_cmd.YHSM_YubiKeySecret-class.html"
          class="link">pyhsm.aead_cmd.YHSM_YubiKeySecret</a></li>
        <li><strong class="pname"><code>nonce</code></strong> (None or string) - Nonce, if different from public_id.</li>
    </ul></dd>
    <dt>Returns: bool</dt>
        <dd>True on success</dd>
  </dl>
<div class="fields">      <p><strong>See Also:</strong>
        <a href="pyhsm.db_cmd.YHSM_Cmd_DB_YubiKey_Store-class.html" 
        class="link">pyhsm.db_cmd.YHSM_Cmd_DB_YubiKey_Store</a>
      </p>
</div></td></tr></table>
</div>
<a name="db_validate_yubikey_otp"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">db_validate_yubikey_otp</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">public_id</span>,
        <span class="sig-arg">otp</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>Request the YubiHSM to validate an OTP for a YubiKey stored in the 
  internal database.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>public_id</code></strong> (string) - The six bytes public id of the YubiKey</li>
        <li><strong class="pname"><code>otp</code></strong> (string) - The OTP from a YubiKey in binary form (16 bytes)</li>
    </ul></dd>
    <dt>Returns: <a href="pyhsm.validate_cmd.YHSM_ValidationResult-class.html" 
      class="link">YHSM_ValidationResult</a></dt>
        <dd>validation response</dd>
  </dl>
<div class="fields">      <p><strong>See Also:</strong>
        <a href="pyhsm.db_cmd.YHSM_Cmd_DB_Validate_OTP-class.html" 
        class="link">pyhsm.db_cmd.YHSM_Cmd_DB_Validate_OTP</a>
      </p>
</div></td></tr></table>
</div>
<br />
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">
  <!-- Home link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="pyhsm-module.html">Home</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Project homepage -->
      <th class="navbar" align="right" width="100%">
        <table border="0" cellpadding="0" cellspacing="0">
          <tr><th class="navbar" align="center"
            >pyhsm</th>
          </tr></table></th>
  </tr>
</table>
<table border="0" cellpadding="0" cellspacing="0" width="100%%">
  <tr>
    <td align="left" class="footer">
    Generated by Epydoc 3.0.1 on Thu Sep 18 11:08:06 2014
    </td>
    <td align="right" class="footer">
      <a target="mainFrame" href="http://epydoc.sourceforge.net"
        >http://epydoc.sourceforge.net</a>
    </td>
  </tr>
</table>

<script type="text/javascript">
  <!--
  // Private objects are initially displayed (because if
  // javascript is turned off then we want them to be
  // visible); but by default, we want to hide them.  So hide
  // them unless we have a cookie that says to show them.
  checkCookie();
  // -->
</script>
</body>
</html>
